"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.withState = withState;

var _dom = _interopRequireDefault(require("./dom"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function updateElement(parent, next, prev) {
  // later virtualDOM mods
  if (!next.isEqualNode(prev)) {
    parent.replaceChild(next, parent.firstChild);
  }
} // eslint-disable-next-line


function withState(elements, store) {
  var parentNode;
  var nextProps;
  store.subscribe(function () {
    var nextNode = (0, _dom.default)(function () {
      return elements(nextProps);
    });
    updateElement(parentNode, nextNode, parentNode.firstChild);
  });
  return function (props) {
    nextProps = props;
    return (0, _dom.default)('span', {
      ref: function ref(node) {
        parentNode = node;
      }
    }, elements(props));
  };
}